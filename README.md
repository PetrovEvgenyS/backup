# backup.sh

Скрипт для резервного копирования указанных директорий с автоматическим удалением старых архивов.

## Описание

Скрипт архивирует содержимое выбранных папок, сохраняет архивы в отдельной директории и удаляет архивы, которые старше заданного количества дней.

## Использование

1. Отредактируйте переменные:
- `FOLDERS` (массив путей к папкам, для бэкапа),
- `BACKUP_DIR` (куда сохранять архивы),
- `DAYS_TO_KEEP` (сколько дней хранить архивы).

2. Дайте права на выполнение:
   ```sh
   chmod +x backup.sh
   ```

3. Запустите скрипт:
   ```sh
   ./backup.sh
   ```

## Как работает скрипт

- Для каждой папки из списка создаётся архив с текущей датой в имени.
- Архивы сохраняются в указанной директории.
- Всем архивам назначаются права доступа 700.
- Автоматически удаляются архивы, которые старше заданного количества дней.
- Все действия сопровождаются комментариями и выводом в консоль.

## Пример строки для cron

```sh
0 2 * * * /path/to/backup.sh
```

## Примечания

- Скрипт проверяет существование каждой папки перед архивированием.
- Для удаления старых архивов используется команда:
  ```sh
  find . -maxdepth 1 -type f -mtime +$DAYS_TO_KEEP -print0 | xargs -0 --no-run-if-empty rm -f
  ```

### Подробный разбор команды удаления архивов

- `find .` — ищет файлы и папки в текущей директории.
- `-maxdepth 1` — не спускаться в поддиректории, искать только в текущей папке.
- `-type f` — искать только обычные файлы (не папки).
- `-mtime +$DAYS_TO_KEEP` — искать файлы, изменённые более чем $DAYS_TO_KEEP дней назад.
- `-print0` — выводить имена файлов, разделяя их нулевым байтом (для корректной работы с пробелами и спецсимволами).
- `|` — передаёт список найденных файлов следующей команде.
- `xargs -0` — принимает список файлов, разделённых нулевым байтом, и передаёт их следующей команде.
- `--no-run-if-empty` — не запускать команду удаления, если список файлов пуст.
- `rm -f` — удаляет найденные файлы без запроса подтверждения.
